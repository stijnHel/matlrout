function D=leesvsopdata(fn)% LEESVSOPDATA - Leest data uit VSOP87 tabellenfid=fopen(fn);if fid<3	error('Kan file niet openen')endD=[];X=[];nX=0;H='';while ~feof(fid)	l=fgetl(fid);	if length(l)<10		% wat doen?	elseif any(l>='A'&l<='Z')		if nX			D(end).data=X(1:nX,:);			if nX~=nterm				warning(sprintf('!Ander aantal termen dan verwacht!\n   %s',H))			end			nX=0;			H='';		elseif ~isempty(H)			warning(sprintf('lijn weggegooid?\n     %s',H))		end		[typ,n,err,in]=sscanf(l,'%s',1);		[s,n,err,in1]=sscanf(l(in+1:end),'%s',1);		in=in+in1;		if ~strcmp(s,'VERSION')			warning('!!verkeerde interpretatie van header!!')		end		[vers,n,err,in1]=sscanf(l(in+1:end),'%s',1);		in=in+in1;		[planeet,n,err,in1]=sscanf(l(in+1:end),'%s',1);		in=in+in1;		[s,n,err,in1]=sscanf(l(in+1:end),'%s',1);		in=in+in1;		if ~strcmp(s,'VARIABLE')			warning('!!verkeerde interpretatie van header!!(2)')		end		[vnr,n,err,in1]=sscanf(l(in+1:end),'%d',1);		in=in+in1;		[s,n,err,in1]=sscanf(l(in+1:end),'%s',1);		in=in+in1;		if ~strcmp(s,'(LBR)')			warning('!!verkeerde interpretatie van header!!(3)')		end		[spow,n,err,in1]=sscanf(l(in+1:end),'%s',1);		in=in+in1;		if ~strcmp(spow(1:4),'*T**')			warning('!!verkeerde interpretatie van header!!(4)')		end		pow=str2num(spow(5:end));		[nterm,n,err,in1]=sscanf(l(in+1:end),'%d',1);		D(end+1).head=l;		D(end).typ=typ;		D(end).vers=vers;		D(end).planeet=planeet;		D(end).vnr=vnr;		D(end).power=pow;		D(end).nterm=nterm;		H=l;	else		d1=sscanf(l,'%g')';		if isempty(X)			X=zeros(1500,length(d1));		end		nX=nX+1;		X(nX,:)=d1;	endendif nX	if nX~=nterm		warning(sprintf('!Ander aantal termen dan verwacht!\n   %s',H))	end	D(end).data=X(1:nX,:);endfclose(fid);